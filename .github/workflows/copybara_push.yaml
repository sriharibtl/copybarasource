on: push

jobs:
  move-code:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
        with:
          path: /tmp/copybarasource
      - name: Setup Bazel
        uses: abhinavsingh/setup-bazel@v3
        with:
          version: 4.2.1
      - name: Setup Java JDK
        uses: actions/setup-java@v2.3.1
        with:
          java-version: 1.8.0_301
          distribution: jre
      - name: checkout copybara repo
        uses: actions/checkout@v2
        with:
          repository: google/copybara
          path: copybara
      - run: cd copybara bazel 
      - run: build java/com/google/copybara
      - run: java/com/google/copybara /tmp/copybarasource/copy.bara.sky
